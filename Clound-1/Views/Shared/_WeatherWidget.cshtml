@model WeatherModel

<div class="weather-widget d-flex flex-column h-100">
    <h4 class="mb-3">🌤 Погода сейчас</h4>

    <!-- Форма для выбора города (отправляет GET) -->
    <form method="get" id="cityForm" class="mb-3">
        <select name="city" id="citySelector" class="form-select">
            <option value="Москва" selected="@(Model?.City == "Москва")">Москва</option>
           
            <option value="Казань" selected="@(Model?.City == "Казань")">Казань</option>
            <option value="Новосибирск" selected="@(Model?.City == "Новосибирск")">Новосибирск</option>
            <option value="Екатеринбург" selected="@(Model?.City == "Екатеринбург")">Екатеринбург</option>
        </select>
    </form>

    <!-- Данные о погоде -->
    <div id="weather-content">
        <p><strong>📍 Город:</strong> <span id="city">@(Model?.City ?? "Неизвестно")</span></p>
        <p><strong>🌡 Температура:</strong> <span id="temp">@(Model?.Temperature ?? 0)</span>°C</p>
        <p><strong>💨 Ветер:</strong> <span id="wind">@(Model?.WindSpeed ?? 0)</span> км/ч</p>
        <p class="display-6 mt-3" id="weather-desc">@(Model?.Description ?? "Загрузка...")</p>
    </div>

    <!-- Кнопки внизу -->
    <div class="mt-auto d-flex gap-2">
        <!-- Кнопка "Обновить" перезагружает страницу с тем же городом -->
        <button type="button" id="refreshWeather" class="btn btn-outline-primary btn-sm flex-fill"
                onclick="window.location.href = window.location.pathname + '?city=' + document.getElementById('citySelector').value">
            🔄 Обновить
        </button>
        <!-- Ссылка на облака с текущим городом -->
        <a id="goToCloud" href="/Cloud?city=@(Model?.City)" class="btn btn-outline-info btn-sm flex-fill">
            ☁️ Облака
        </a>
    </div>
</div>


<script>

    document.getElementById('citySelector')?.addEventListener('change', function() {
         const city = this.value;
        window.location.href = '/Cloud?city=' + encodeURIComponent(city);
        document.getElementById('goToCloud').href = '/Cloud?city=' + encodeURIComponent(this.value);
    });

        document.getElementById('refreshWeather')?.addEventListener('click', function() {
        const city = document.getElementById('citySelector').value;
        window.location.href = window.location.pathname + '?city=' + encodeURIComponent(city);
    });

</script>

<style>
    .weather-widget {
        flex: 1;
        display: flex;
        flex-direction: column;
        min-height: 0;
        background: rgba(255,255,255,0.2);
        backdrop-filter: blur(8px);
        border-radius: 1.5rem;
        padding: 1.5rem;
    }
    .mt-auto {
        margin-top: auto !important;
    }
</style>